% removeOutliers
% Created by Patrick Wilson on 1/20/2020
% Github.com/patrickmwilson
% Created for the Elegant Mind Collaboration at UCLA under Professor Katsushi Arisaka
% Copyright © 2020 Elegant Mind Collaboration. All rights reserved.

% Accepts a matrix, a cutoff Z-score, and the index of interest as input. 
% Recursively computes the Z-score of the column specified by the index of interest
% and removes elements that have a Z-score higher than the cutoff, as well as the 
% corresponding elements in the second array.

function newData = removeOutliers(data, cutOff, indexOfInterest)
    
    newData = data;
    newData(:,(size(data,2)+1)) = zscore(data(:,indexOfInterest));

    i = 1;
    while(i <= size(newData,1))
        if(abs(newData(i,(size(data,2)+1))) > cutOff)
            newData(i,:) = [];
            continue;
        end
        i = i+1;
    end
    
    newData(:,(size(data,2)+1)) = [];
    
    if(size(newData,1) ~= size(data,1))
        newData = removeOutliers(newData, cutOff);
    end
    
end
